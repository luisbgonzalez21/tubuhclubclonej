"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[3669],{67927:function(t,e,o){o.r(e),o.d(e,{LightboxSymbol:function(){return n.cC},LightboxUtilsSymbol:function(){return n.r5},name:function(){return n.u2},page:function(){return E},site:function(){return F}});var n=o(42933),i=o(21980),a=o(3285),r=o(13487),p=o(56510),u=o(25259),g=o(2922),s=o(14439),c=o(24888),l=o(52192),d=o(22200),h=o(26725),b=o(6233),f=o(99306),m=o(89501);const x=(0,p.ff)([h.xf,i.ZQ,(0,p.t6)(u.Wf,n.u2),(0,p.t6)(u.R9,n.u2),(0,p.t6)(u.jC,n.u2),h.JR,b.O,g.jj,n.FZ,d.a,n.j_,n.dj,s.U,m.b,c.O],(({initPage:t},e,o,{pageIdToRouterFetchData:n},i,a,p,u,g,s,c,{handleResponse:d},h,{getFetchParams:b},m)=>{const x=[],P=[];let L,v=null;const y=t=>{"Escape"===t.key&&I()},I=async()=>{const t=C();if(!t)return;const{pendingLightboxId:n}=o.get()||{},i=n&&n!==t,p=v,u=await a(t,t),d=await u.getAllImplementersOfAsync(r.j.PageWillUnmountHandler);if(await Promise.all(d.map((e=>e.pageWillUnmount({pageId:t,contextId:t})))),c.removeLightboxFromDynamicStructure(t),p?.(),P.forEach((t=>t?.())),i)return;s.disableCyclicTabbing(t),(0,l.yF)(e)||e.removeEventListener("keydown",y);const h=g.isDuringReopen()?C():void 0;o.update((t=>({...t,pageWillLoadHandler:null,currentLightboxId:h,pendingLightboxId:void 0,lightboxRouteData:void 0})))},C=()=>o.get()?o.get().currentLightboxId:void 0,O=async(i,a)=>{if(!!m["specs.thunderbolt.app_reflow_with_lightboxes"]){const t=n[i];if(t){const{url:e,options:o}=b(f.i.Lightboxes,t,{lightboxId:i}),{pageId:n}=await d(h.envFetch(e,o));i=n??i}}if((t=>{if(g.isDuringReopen())return!1;const e=o.get();return e?.currentLightboxId===t||e?.pendingLightboxId===t})(i))return void(v=v||a);o.update((t=>({...t,pendingLightboxId:i}))),s.enableCyclicTabbing(i);const r=!u.isLandingOnProtectedPage();r&&(p.startNavigation(),p.setShouldBlockRender(!0)),await t({pageId:i,contextId:i}),v=a,x.length>0&&x.forEach((t=>{t&&t(i)})),(0,l.yF)(e)||e.addEventListener("keydown",y),r&&p.setShouldBlockRender(!1),await c.addLightboxToDynamicStructure(i),o.update((t=>({...t,pageWillLoadHandler:I,currentLightboxId:i}))),r&&p.endNavigation()};return{isLightbox(t){return i.popupPages[t]},open(t,e=null){const n=(o.get()?.pendingLightboxPromise||Promise.resolve()).then((()=>O(t,e)));return o.update((t=>({...t,pendingLightboxPromise:n}))),n},close:I,registerToLightboxEvent(t,o){switch(t){case"popupScroll":L=o;const t=e.document.getElementById("POPUPS_ROOT"),n=t?.querySelector('div[class*="overflow-wrapper"]'),a=i.isResponsive&&n||t;a&&a.addEventListener("scroll",L);break;case"popupOpen":x.push(o);break;case"popupClose":P.push(o)}},getCurrentLightboxId:C,isOpen:()=>!!C()}})),P=(0,p.ff)([],(()=>({isDuringReopen:()=>!1}))),L=(0,p.ff)([(0,p.t6)(u.Wf,"lightbox"),b.O,g.jj],((t,e,o)=>({name:"popupsPageNavigationHandler",appWillLoadPage:()=>{e.isFirstNavigation()&&!o.isLandingOnProtectedPage()&&t.update((t=>({...t,pendingLightboxPromise:e.waitForNavigationEnd()}))),t.get()?.pageWillLoadHandler?.()}})));var v=o(61867),y=o(75471);const I=["SCROLL_TO_TOP","SCROLL_TO_BOTTOM"],C=(0,p.ff)([n.cC,y.Iz],((t,e)=>({handlerId:n.u2,handleClick:o=>{const n=o.getAttribute("data-popupid");if(n)return t.open(n),!0;const i=e.getFullUrlWithoutQueryParams(),a=!!t.getCurrentLightboxId(),r=o.getAttribute("href"),p=r&&(0,v.Gw)(r),u=(0,v.Ph)(i)===(0,v.Ph)(p||""),g=o.getAttribute("data-anchor")||"",s=I.includes(g),c="_blank"===o.getAttribute("target");return!(!a||!u&&!s||c)&&(t.close(),!0)}})));var O=o(31873);const R=(0,p.ff)([n.cC,O.G],((t,e)=>({componentTypes:["PopupCloseIconButton"],componentWillMount(o){e.register(o.id,"onClick",t.close)}}))),_=(0,p.ff)([(0,p.t6)(u.$e,n.u2),n.cC,O.G],(({closeSiteButtons:t},e,o)=>({componentTypes:["SiteButton"],componentWillMount(n){t[n.id]&&o.register(n.id,"onClick",e.close)}}))),w=(0,p.ff)([(0,p.t6)(u.$e,n.u2),n.cC,O.G],(({popupsWithCloseOnOverlayClick:t},e,o)=>({componentTypes:["PopupPage","ResponsivePopupPage"],componentWillMount(n){t[n.id]&&o.register(n.id,"onClick",e.close)}}))),D=(0,p.ff)([(0,p.t6)(u.jC,n.u2),(0,p.t6)(u.Wf,n.u2)],((t,e)=>({isLightbox(e){return t.popupPages[e]},getCurrentLightboxId(){return e.get()?.pendingLightboxId||e.get()?.currentLightboxId},getLightboxPages(){return t.popupPages},getLightboxRouteData(){return e.get()?.lightboxRouteData}}))),T=(0,p.ff)([n.r5,c.O],((t,e)=>{const o=!!e["specs.thunderbolt.app_reflow_with_lightboxes"];return{platformEnvData(){return{popups:{popupPages:t.getLightboxPages(),lightboxRouteData:o?t.getLightboxRouteData():void 0}}}}}));var S=o(27451),W=o(55437);const k=(0,p.ff)([W.QZ,(0,p.t6)(u.jC,n.u2),(0,p.t6)(u.z8,n.u2)],((t,e,o)=>({addLightboxToDynamicStructure:n=>{const i=t.getPageWrapperComponentId(n,n);return o.export({lightboxPageId:n}),t.addComponentToDynamicStructure("POPUPS_ROOT",{componentType:"PopupRoot",components:[i],uiType:e.isResponsive?"Responsive":"Classic"},{[i]:{componentType:"PageMountUnmount",components:[n]}})},removeLightboxFromDynamicStructure:e=>{const n=t.getPageWrapperComponentId(e,e);t.removeComponentFromDynamicStructure(n),t.removeComponentFromDynamicStructure("POPUPS_ROOT"),o.export({lightboxPageId:void 0})}}))),j=(0,p.ff)([(0,p.t6)(u.Wf,n.u2)],(t=>({async handleResponse(e){return e.then((async e=>{if(!e.ok)throw e;const{result:o}=await e.json(),{page:n,data:i,head:a,publicData:r}=o,p={publicData:r,pageHeadData:a,pageData:i};return t.update((t=>({...t,lightboxRouteData:p}))),{pageId:n||null}})).catch((()=>({pageId:null})))}}))),F=t=>{t(n.FZ).to(P),t(n.cC).to(x),t(i.dY).to(T),t(n.r5).to(D),t(a.QV).to(C),t(r.j.AppWillLoadPageHandler).to(L),t(n.j_).to(k),t(n.dj).to(j)},E=t=>{t(S.Vx).to(R),t(S.Vx).to(_),t(S.Vx).to(w)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/group_20.c4ce16d1.chunk.min.js.map